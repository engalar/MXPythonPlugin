#### **项目概述**

本项目用于管理一组插件，其中每个插件都作为独立的子目录存在。核心工作流是通过 GitHub Gist 来存储和同步每个插件的源代码和元数据。通过自动化脚本，我们可以根据本地 Git 仓库的文件变更状态，智能地生成用于创建或更新 Gist 的 `gh` CLI 命令，从而简化插件的发布和维护流程。

#### **插件目录结构**

每个插件都遵循统一的目录结构，以便于自动化处理：

```
.
└── a-plugin-directory/      # 插件的根目录
    ├── manifest.json        # [必需] 插件清单文件，核心元数据
    ├── main.py              # [可选] 后端源代码文件（由 manifest.json 的 "plugin" 字段指定）
    ├── index.html           # [可选] 前端 UI 文件（由 manifest.json 的 "ui" 字段指定）
    └── README.md            # [可选] 插件的说明文档
```

#### **核心组件：`manifest.json`**

清单文件 `manifest.json` 是每个插件的“身份证”，定义了其属性和文件关联：

*   `"home"`: (字符串) 插件对应的 GitHub Gist 的 URL。
    *   **如果存在此字段**：表示该插件已经上传，后续操作为**更新 (edit)**。
    *   **如果不存在或为空**：表示这是一个新插件，需要**创建 (create)** 一个新的 Gist。
*   `"ui"`: (字符串) 指向前端 UI 文件的相对路径，例如 `"index.html"`。
*   `"plugin"`: (字符串) 指向后端源代码文件的相对路径，例如 `"main.py"`。
*   `"description"`: (字符串, 推荐) 插件的简短描述，用于创建 Gist 时的说明。

#### **自动化工作流**

1.  **检测变更**：脚本首先使用 `git status` 命令来识别出所有被修改、新增或未被追踪的插件文件。
2.  **识别插件**：根据变更文件的路径，确定哪些插件目录受到了影响。
3.  **解析清单**：读取受影响插件的 `manifest.json` 文件。
4.  **决策与生成命令**：
    *   **对于已有 `home` 字段的插件**：脚本会提取 Gist ID，并生成 `gh gist edit` 命令，将该插件目录下的所有相关文件（`manifest.json`, `ui` 文件, `plugin` 文件, `README.md`）一并更新。
    *   **对于没有 `home` 字段的插件**：脚本会生成 `gh gist create` 命令，将插件的所有文件作为一个新的公开 Gist 上传。同时，会提示您在创建成功后，手动将新的 Gist URL 添加回 `manifest.json` 文件中。
